"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var docker_1 = require("../docker");
function detect(targetImage, options) {
    return tslib_1.__awaiter(this, void 0, void 0, function () {
        var info, error_1;
        return tslib_1.__generator(this, function (_a) {
            switch (_a.label) {
                case 0:
                    _a.trys.push([0, 2, , 3]);
                    return [4 /*yield*/, new docker_1.Docker(targetImage, options)
                            .inspect(targetImage)];
                case 1:
                    info = _a.sent();
                    return [2 /*return*/, JSON.parse(info.stdout)[0]];
                case 2:
                    error_1 = _a.sent();
                    if (error_1.stderr.includes('No such object')) {
                        throw new Error("Docker error: image was not found locally: " + targetImage);
                    }
                    throw new Error("Docker error: " + error_1.stderr);
                case 3: return [2 /*return*/];
            }
        });
    });
}
exports.detect = detect;
//# sourceMappingURL=image-inspector.js.map